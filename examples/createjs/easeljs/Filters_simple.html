<!DOCTYPE html>
<html>
<head>
<title>EaselJS: Filters Example</title>

<link href="assets/demoStyles.css" rel="stylesheet" type="text/css" />

<script type="text/javascript" src="../../../src/xc.js"></script>

<script>
xc.depends([
    "../../../src/core",
    "../../../src/lib/createjs"
], function() {

    var Stage = xc.module.require("xc.createjs.Stage");
    var Bitmap = xc.module.require("xc.createjs.Bitmap");
    var BoxBlurFilter = xc.module.require("xc.createjs.BoxBlurFilter");
    var Ticker = xc.module.require("xc.createjs.Ticker");

    var img;
    var stage;
    var angle;
    var canvas;
    var range;
    var speed;

    function init() {
        angle = 0;
        range = 30;
        speed = 0.1;
        img = new Image();
        img.onload = handleImageLoad;
        img.src = "assets/flowers.jpg";
    }

    function handleImageLoad() {
        canvas = document.getElementById("testCanvas");
        stage = new Stage(canvas);

        bmp = new Bitmap(img);
        bmp.cache(0, 0, img.width, img.height);

        stage.addChild(bmp);

        Ticker.setFPS(15);
        Ticker.addEventListener("tick", tick);
    }

    function tick() {
        angle += speed;
        updateImage();
    }

    function updateImage() {
        var value = Math.sin(angle)*range;
        bmp.updateCache();
        bmp.filters = [new BoxBlurFilter(value,  value, 2)];
        stage.update();
    }

    init();
});
</script>
</head>
<body>

	<header id="header" class="EaselJS">
	    <h1><span class="text-product">Easel<strong>JS</strong></span> Simple Filter Example</h1>
	    <p>This sample loads an image, and applies a blur filter each frame with a varying value.</p>
	</header>

    <canvas id="testCanvas" width="960" height="400"></canvas>

</body>
</html>